---
title: "Are RSL Fans Better Than Utah Jazz Fans?"
date: "April 29, 2022"
author: "Tom Coe, Joey Brignone, Darren Rou"
output:
  html_document:
    number_sections: true
  pdf_document:
    number_sections: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggplot2)
library(kableExtra)
```

# Introduction

In this day and age almost everything has turned into a competition, some of the most competitive being professional sports. Sports are at the core of our competitive nature and are captivating to watch. Fans become so involved in the victories and losses of their respective favorite team that they start using pronouns such as 'we' when referring to the teams recent achievements. Logically, being a dedicated fan is a competition in itself. It's not easy showing up to games and cheering for hours on end. Any dedicated fan will know the pains of waking up the morning after a big game with a sore throat and trouble speaking. The question remains, how are fans supposed to know who the *best* fans in Utah are? This study aims to answer that very question by investigating the celebration times of Salt Lake City's (SLC's) professional sports teams' fans. To make this a fair competition we will first have to determine how many points one point in soccer is worth in basketball. We will use this number as a weight to determine who cheers harder and ultimately who are the better fans.

# Data Discovery

## Scoring Data

[nba.com](https://www.nba.com/stats/teams/boxscores/?Season=2020-21&SeasonType=Regular%20Season&CF=TEAM_NAME*E*Utah%20Jazz) provides scoring data for NBA teams. This website allows filtering of data by team, season, and the type of game (regular, playoffs, etc.). We note that there aren't many playoff games for the Jazz. With this taken into consideration, we choose to take all scoring data from playoff, play-in, and regular season games. We do with the assumption that games scores do not depend on the type of game. This assumption is reasonable for our purposes.

Similar to how we obtained data from nba.com ,[kaggle.com](https://www.kaggle.com/datasets/josephvm/major-league-soccer-dataset?resource=download&select=matches.csv), provides scoring data for MLS teams. For our study we have pulled data only relating to RSL teams for our sample.

## Cheering Data

To collect data, we watched RSL and Jazz games and observed the crowd when there was an instance of scoring. Then, using a stopwatch we timed the duration of the crowd's cheering. For the basketball games this was simple as there are no cuts in the video feed, but for soccer game this was a little harder. Since there is a delay in game play after a goal is scored in soccer the broadcasting network cuts away from the live feed and shows instant replays. These replays, however, still have live audio from the commentators and the crowd can still be heard. Thus, to gather data for the celebration time we focused on listening to the crowd during the replays and did our best to estimate when the crowd had stopped cheering. The act of timing the crowd's reaction introduces error in itself, but the added difficulty of not having a single continuous video feed made accurate data collection even more difficult. 


# Methodology

After data collection, we were given many measurements from which to choose from. The first important population sample we wish to evaluate will be the scores per game. In order to adequately answer our question of how much one point in soccer is compared to one point in basketball, we will need to take the scoring data collected and compare the means of each data set. To do this we will assuming these data sets follow a normal distribution and will use t-tests to construct confidence intervals to approximate the value of the population means. Since we are fairly confident in our data, yet we recognize possible biases that are present, we will be using a confidence interval of 95%. Through this t-test of 95% confidence, we can find a range for the population mean for the scores per game of RSL and the Jazz.

Next, we wish to use this information answer which fans are better. As mentioned earlier, counting the amount of fans with sore throats after each game would not be effective nor sanitary to say the least. However, by using the duration of cheering after each point, we believe that this method equally measures the fans' passion for the team. From our data sets, we will take the sample of cheer time per point, plot a histogram and normal curve, and analyze our results. This should prepare us to run another t-test of this sample, to find a range wherein lies the population mean. For consistency, we will use the 95% confidence interval from before. Once both t-tests are run for both cheer time data sets, we may start to draw conclusions from our results.

# Analysis

## One Point In Soccer Is Worth X Points In Baseketball

We consider scoring data for the Utah Jazz during the 2020-2021 and 2019-2020 regular season. More specifically, we consider the total points scored by the Jazz each game. This data about total points is available [from NBA.com](https://www.nba.com/stats/teams/boxscores/?Season=2020-21&SeasonType=Regular%20Season&CF=TEAM_NAME*E*Utah%20Jazz). We put this data into a `.csv` file, and using the `head()` function, we can create a table to see what it looks like:

```{r}
nbaPreliminaryData = read.csv("jazzScores.csv") # data from nba.com
knitr::kable(head(nbaPreliminaryData[,0:6]),align='c',
             col.names=c('Team','Match Up','Game Date','W/L','Min','Points')) %>%
  kable_styling(full_width = F)
```

As we can see, the `PTS` column corresponds to total points scored by the Jazz during a game.

Mathematically, let $X$ be the total number of points scored by the Jazz in an NBA game. Our sample (shown earlier) represents only a small subset of the population, but it is sufficient for the motivation for this study. The following code block does some basic analysis on the data.

```{r}
nbaScores = nbaPreliminaryData$PTS
nbaScoresCount = length(nbaScores) # sample size
nbaScoresMean = mean(nbaScores) # sample mean
nbaScoresSd = sd(nbaScores) # sample standard deviation
summary(nbaScores)

nbaScoresRange <- min(nbaScores):max(nbaScores)
nbaScoresNormal <- dnorm(nbaScoresRange,mean=nbaScoresMean,sd=nbaScoresSd)
plot(nbaScoresRange,nbaScoresNormal,main="Histogram of total points (NBA) and Normal Curve",
     xlab="Total points scored by a team in a game",ylab = 'Density')
hist(nbaScores,freq=FALSE,add=TRUE, col = rgb(0,0,0,alpha=0.1))

```

With this sample size of ${n_X=}$ `r nbaScoresCount`, we find the sample mean to be ${\bar{x}=}$ `r nbaScoresMean` and the sample standard deviation to be ${s_{X}=}$ `r nbaScoresSd`. As shown by the previous histogram, the data is approximately normal, and using a t-distribution for analysis is suitable:

```{r}
nbaScoresTtest = t.test(nbaScores)
nbaScoresTtest
```

The previous t-test gives a 95% confidence interval of (`r nbaScoresTtest$conf.int[1]`, `r nbaScoresTtest$conf.int[2]`). In terms of NBA scores, this interval is quite small. Our sample suggests the mean points scored by a team in an NBA points in this interval with 95% confidence.

Note that the data we obtained from nba.com is biased. We only sampled from the 2020-2021 season, and we only sampled from playoff games. But for our purposes, this biased sample should be sufficient.

Now, we consider data for the MLS. Data for the MLS is available [from kaggle.com](https://www.kaggle.com/datasets/josephvm/major-league-soccer-dataset?resource=download&select=matches.csv). Similar to our NBA analysis, we want to consider the total points scored each team in a game.

```{r}
mlsPreliminaryData = read.csv("rslScores.csv")
knitr::kable(head(mlsPreliminaryData),col.names=c('Team','Final Score','Year'),align='c') %>%
  kable_styling(full_width = F)
```

Above is a table representing the data retrieved from kaggle.com. The column we are interested in for our study's purposes is the final score.

Similar to before, let $Y$ be the total number of points scored by a team in an MLS game.

```{r}
mlsScores = mlsPreliminaryData$Final.Score
mlsScoresCount = length(mlsScores)
mlsScoresMean = mean(mlsScores)
mlsScoresSd = sd(mlsScores)

mlsScoreRange <- c(min(mlsScores):(2*max(mlsScores)))/2
mlsScoreNormal <- dnorm(mlsScoreRange,mean=mlsScoresMean,sd=mlsScoresSd)
plot(mlsScoreRange,mlsScoreNormal,main="Histogram of total points (MLS) and Normal Curve",
     xlab="Total points scored by a team in a game",ylab = 'Density')
hist(mlsScores,breaks=-.5:8.5,freq=FALSE,add=TRUE, col = rgb(0,0,0,alpha=0.1))
```

With our sample size of ${n_Y=}$ `r mlsScoresCount`, we find the sample mean to be ${\bar{y}=}$ `r mlsScoresMean`, and we find the sample standard deviation to be ${s_{Y}=}$ `r mlsScoresSd`. Compared to the sample mean, the sample standard deviation is quite large. The previous histograms shows that RSL scores approximately follow a normal distribution. Note that the data seems to be skewed left. We can use a t-test to find a confidence interval:

```{r}
mlsScoresTtest = t.test(mlsScores)
mlsScoresTtest
```

From the t-test, we find a 95% confidence interval of (`r mlsScoresTtest$conf.int[1]`, `r mlsScoresTtest$conf.int[2]`).

As with the NBA case, our data for MLS scores may be biased, but it should be sufficient for our purposes. We may do a two-variable t-test to compare NBA scores to MLS scores:
```{r}
nbaMlsTtest = t.test(nbaScores, mlsScores)
nbaMlsTtest
```

The previous t-test suggests that NBA games usually have much higher scores than MLS games. If this is the case, then viewers of sports games may feel like points in MLS games are harder to obtain. We will now compare the ranges of population means for Jazz games and RSL games that we derived with our t-tests. The low end of the Jazz scoring mean is `r nbaScoresTtest$conf.int[1]` and the high end of the mean for RSL is `r mlsScoresTtest$conf.int[2]`. We will create a ratio by dividing these by each other. This will show us the lowest ratio between our population means. We will also compute this ratio for the high end of the interval by using the upper bound of the Jazz means and the lower bound of the RSL mean. This will give us the maximum ratio between these two means.

```{r}
lowRatio <- nbaScoresTtest$conf.int[1]/mlsScoresTtest$conf.int[2]
highRatio <- nbaScoresTtest$conf.int[2]/mlsScoresTtest$conf.int[1]
```

Here we have completed these computation and arrived at a ratio of `r lowRatio` for the lower bound and `r highRatio` for the higher bound. This means that one point scored by RSL is at least equivalent to `r lowRatio` Jazz points and at most equivalent to `r highRatio` Jazz points. These values will be crucial in determining if RSL fans truly cheer harder than Jazz fans.

## Who Are the Better Fans

First we will take the data we collected and compute the mean values for each. Similar to what we did in the previous section for the scoring data.

```{r}
# import cheering data
jazzData = read.csv("jazzFanData.csv")
jazzCelebrationTimes = jazzData$Celebration.Time

knitr::kable(head(jazzData),col.names=c('Opposing Team','Year','Game Time',
                                        'Point #', 'Celebration  Time','Location'),align='c') %>%
  kable_styling(full_width = F)
```

The table above shows the variables we tracked when watching Jazz games. The variable we are most interested in for this study is celebration time. Next we will use this data and create a histogram.

```{r}
jazzCelebrationCount = length(jazzCelebrationTimes)
jazzCelebrationMean = mean(jazzCelebrationTimes)
jazzCelebreationSd = sd(jazzCelebrationTimes)

jazzCelebrationBreaks = c(min(jazzCelebrationTimes):max(jazzCelebrationTimes))
jazzCelebrationRange <- c(0:12)
jazzCelebrationNormal <- dnorm(jazzCelebrationRange,mean=jazzCelebrationMean,sd=jazzCelebreationSd)
plot(jazzCelebrationRange,jazzCelebrationNormal,main="Histogram of Celebration Time (Jazz) and Normal Curve",xlab="Total Time Fans Cheered After a Score",ylab = 'Density')
hist(jazzCelebrationTimes,breaks=6,freq=FALSE,add=TRUE, col = rgb(0,0,0,alpha=0.1))
```

```{r}
rslData = read.csv("rslFanData.csv")
rslCelebrationTimes = rslData$Celebration.Time

knitr::kable(head(rslData),col.names=c('Opposing Team','Year','Game Time',
                                       'Point #','Celebration Time','Location'),align = 'c') %>%
  kable_styling(full_width = F)

```


Here we have created a histogram of our cheering data for Utah Jazz fans. We observe this follows close enough to a normal distribution to perform a t-test. Therefore, we will conduct a t-test with a 95% confidence interval to provide good evidence to the range of the population mean.


```{r}
jazzCelebrationTtest <- t.test(jazzCelebrationTimes)
jazzCelebrationTtest
```
From this t-test we have observed with 95% confidence the population mean will be within (`r jazzCelebrationTtest$conf.int[1]`, `r jazzCelebrationTtest$conf.int[2]`) seconds. Now we will do this same analysis on the RSL fan data.

```{r}
rslData = read.csv("rslFanData.csv")
rslCelebrationTimes = rslData$Celebration.Time

knitr::kable(head(rslData),col.names=c('Opposing Team','Year','Game Time',
                                        'Point #', 'Celebration  Time','Location'),align='c') %>%
  kable_styling(full_width = F)
```

Just like the Jazz fan data we have tracked variables of opposing team, year, game time, point number, celebration time, and location. We will be focusing on the celebration time in this analysis. First we will calculate mean and standard deviation values. Then we will use these values to create a normal curve distribution and overlay this with a histogram from our data.

```{r}
rslCelebrationCount = length(rslCelebrationTimes)
rslCelebrationMean = mean(rslCelebrationTimes)
rslCelebreationSd = sd(rslCelebrationTimes)

rslCelebrationBreaks = c(min(rslCelebrationTimes):max(rslCelebrationTimes))
rslCelebrationRange <- c(10:100)
rslCelebrationNormal <- dnorm(rslCelebrationRange,mean=rslCelebrationMean,sd=rslCelebreationSd)
plot(rslCelebrationRange,rslCelebrationNormal,main="Histogram of Celebration Time (RSL) and Normal Curve",xlab="Total Time Fans Cheered After a Score",ylab = 'Density')
hist(rslCelebrationTimes,freq=FALSE,add=TRUE, col = rgb(0,0,0,alpha=0.1))
```

The histogram of our RSL fan data seems to line up decently with a normal distribution. It is shifted a little to the left and has a couple outliers on the right side. This is probably due to some factors such as a game winning goal late into the game. Next, we will conduct a t-test with a 95% confidence interval as we have done with the Jazz fan data.

```{r}
rslCelebrationTtest <- t.test(rslCelebrationTimes)
rslCelebrationTtest
```
From this t-test we have observed with 95% confidence the population mean will be within (`r rslCelebrationTtest$conf.int[1]`, `r rslCelebrationTtest$conf.int[2]`) seconds.

# Conclusion



